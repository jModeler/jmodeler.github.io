<!doctype html><html lang=en><head><title>Sample Size and Effect Size · The Journeyman Modeler
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Journeyman Modeler"><meta name=description content="In this post, I show how the sample size of the treatment and control samples in an A/B test affect the impact size. The assumption here is that the population variances of both samples are known, and the responses of the individual units in these samples are Independent and Identically Distributed (IID), which simplifies this demonstration.

  Setup
  
    
    Link to heading
  

Let&rsquo;s say the responses in the control sample are \(X_i \sim N(\mu_X, \sigma_X^2)\) and the responses in the treatment sample are \(Y_i \sim N(\mu_Y, \sigma_Y^2)\). We want to check if the mean response of the treatment is significantly different from the mean response of the control sample (i.e. we want to check if \(\bar{Y} - \bar{X}\) is statistically different from \(0\))."><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Sample Size and Effect Size"><meta name=twitter:description content="In this post, I show how the sample size of the treatment and control samples in an A/B test affect the impact size. The assumption here is that the population variances of both samples are known, and the responses of the individual units in these samples are Independent and Identically Distributed (IID), which simplifies this demonstration.
Setup Link to heading Let’s say the responses in the control sample are \(X_i \sim N(\mu_X, \sigma_X^2)\) and the responses in the treatment sample are \(Y_i \sim N(\mu_Y, \sigma_Y^2)\). We want to check if the mean response of the treatment is significantly different from the mean response of the control sample (i.e. we want to check if \(\bar{Y} - \bar{X}\) is statistically different from \(0\))."><meta property="og:url" content="http://jmodeler.github.io/posts/2025-04-26-sample-size-and-effect-size/"><meta property="og:site_name" content="The Journeyman Modeler"><meta property="og:title" content="Sample Size and Effect Size"><meta property="og:description" content="In this post, I show how the sample size of the treatment and control samples in an A/B test affect the impact size. The assumption here is that the population variances of both samples are known, and the responses of the individual units in these samples are Independent and Identically Distributed (IID), which simplifies this demonstration.
Setup Link to heading Let’s say the responses in the control sample are \(X_i \sim N(\mu_X, \sigma_X^2)\) and the responses in the treatment sample are \(Y_i \sim N(\mu_Y, \sigma_Y^2)\). We want to check if the mean response of the treatment is significantly different from the mean response of the control sample (i.e. we want to check if \(\bar{Y} - \bar{X}\) is statistically different from \(0\))."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-04-26T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-26T00:00:00+00:00"><meta property="article:tag" content="Math"><meta property="article:tag" content="Statistics"><meta property="article:tag" content="Python"><link rel=canonical href=http://jmodeler.github.io/posts/2025-04-26-sample-size-and-effect-size/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.38c4552ac40f9ae3408bad40358f654ebd8804412fe74ed56f2d6c8a7af82dd3.css integrity="sha256-OMRVKsQPmuNAi61ANY9lTr2IBEEv507Vby1sinr4LdM=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=http://jmodeler.github.io/>The Journeyman Modeler
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/about/>About</a></li><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li></ul></section><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=http://jmodeler.github.io/posts/2025-04-26-sample-size-and-effect-size/>Sample Size and Effect Size</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2025-04-26T00:00:00Z>April 26, 2025
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
4-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/math/>Math</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/statistics/>Statistics</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/python/>Python</a></span></div></div></header><div class=post-content><p>In this post, I show how the sample size of the treatment and control samples in an A/B test affect the impact size. The assumption here is that the population variances of both samples are known, and the responses of the individual units in these samples are Independent and Identically Distributed (IID), which simplifies this demonstration.</p><h3 id=setup>Setup
<a class=heading-link href=#setup><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Let&rsquo;s say the responses in the control sample are <code>\(X_i \sim N(\mu_X, \sigma_X^2)\)</code> and the responses in the treatment sample are <code>\(Y_i \sim N(\mu_Y, \sigma_Y^2)\)</code>. We want to check if the mean response of the treatment is significantly different from the mean response of the control sample (i.e. we want to check if <code>\(\bar{Y} - \bar{X}\)</code> is statistically different from <code>\(0\)</code>).</p><p>Let&rsquo;s say the sample size of the control sample is <code>\(n_X\)</code>, and the sample size of the treatment sample is <code>\(n_Y\)</code>. We know <a href=https://jmodeler.github.io/posts/distribution-sample-mean/ class=external-link target=_blank rel=noopener>from an older post</a> that the distributions of these sample means are given by:
<code>\begin{align} \bar{X} \sim N(\mu_X, \frac{\sigma_X^2}{n_X}) \\ \bar{Y} \sim N(\mu_Y, \frac{\sigma_Y^2}{n_Y}) \end{align}</code></p><h3 id=effect-size>Effect Size
<a class=heading-link href=#effect-size><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>To check whether <code>\(\bar{Y} - \bar{X}\)</code> is statistically different from <code>\(0\)</code>, we&rsquo;ll need the distribution of <code>\(\bar{Y} - \bar{X}\)</code>. From <a href=https://jmodeler.github.io/posts/negative-normal-rv/ class=external-link target=_blank rel=noopener>another post</a>, we know that:
<code>\begin{align} -\bar{X} \sim N(-\mu_X, \frac{\sigma_X^2}{n_X}) \end{align}</code></p><p>We now use the identity <code>\(\bar{Y} - \bar{X} = \bar{Y} + (- \bar{X})\)</code>. Say <code>\(W = (- \bar{X})\)</code>. We know that <code>\(W \sim N(-\mu_X, \frac{\sigma_X^2}{n_X})\)</code>. For the distribution of <code>\(\bar{Y} - \bar{X} = \bar{Y} + W\)</code>, from a <a href=https://en.wikipedia.org/wiki/Sum_of_normally_distributed_random_variables class=external-link target=_blank rel=noopener>standard result</a>, we have:
<code>\begin{align} \bar{Y}-\bar{X} = \bar{Y} + W \sim N(\mu_Y-\mu_X, \frac{\sigma_Y^2}{n_Y} + \frac{\sigma_X^2}{n_X}) \tag{1} \end{align}</code></p><p>We now have the distribution of <code>\(\bar{Y} - \bar{X}\)</code>. For ease of notation, let&rsquo;s set <code>\(\Delta = \bar{Y} - \bar{X}\)</code>. Given the distribution of <code>\(\Delta\)</code> in (1), we also can <a href=https://en.wikipedia.org/wiki/Normalization_%28statistics%29#Standard_score_%28Z-score%29 class=external-link target=_blank rel=noopener>standardize</a> it to get this result:</p><p><code>\begin{align} \frac{\Delta - (\mu_Y-\mu_X)}{\frac{\sigma_Y^2}{n_Y} + \frac{\sigma_X^2}{n_X}} \sim N(0, 1) \end{align}</code></p><h3 id=sample-size-selection>Sample Size Selection
<a class=heading-link href=#sample-size-selection><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>The expression <code>\(\frac{\Delta - (\mu_Y-\mu_X)}{\frac{\sigma_Y^2}{n_Y} + \frac{\sigma_X^2}{n_X}}\)</code> is typically referred to as the test statistic. When designing an experiment, researchers typically only have control over the sample sizes chosen for the treatment and control. In addition, they&rsquo;re also constrained by the total number of units available for experimentation, i.e. <code>\(n_X + n_Y = N\)</code>.</p><p>We&rsquo;d like to choose <code>\(n_X\)</code> and <code>\(n_Y\)</code> in a way that maximizes the test statistic. To derive this value, I first set <code>\(n_X = N - n_Y\)</code> and then take the derivative of the test statistic <code>\(t = \frac{\Delta - (\mu_Y-\mu_X)}{\frac{\sigma_Y^2}{n_Y} + \frac{\sigma_X^2}{N - n_Y}}\)</code> with respect to <code>\(n_Y\)</code>:</p><p><code>\begin{align} \frac{\partial t}{\partial n_Y} = & -\frac{\Delta - (\mu_Y-\mu_X)}{\left(\frac{\sigma_Y^2}{n_Y} + \frac{\sigma_X^2}{N - n_Y}\right)^2} \left(-\frac{\sigma_Y^2}{n_Y^2} + \frac{\sigma_X^2}{(N - n_Y)^2} \right) = 0 \\ \implies & \left(-\frac{\sigma_Y^2}{n_Y^2} + \frac{\sigma_X^2}{(N - n_Y)^2} \right) = 0 \\ \implies & \frac{\sigma_Y^2}{n_Y^2} = \frac{\sigma_X^2}{(N - n_Y)^2} \\ \implies & \frac{\sigma_Y}{n_Y} = \frac{\sigma_X}{(N - n_Y)} \\ \implies & \frac{\sigma_Y}{\sigma_X} = \frac{n_Y}{(N - n_Y)} \\ \implies & \frac{n_Y}{N} = \frac{\sigma_Y}{\sigma_Y + \sigma_X} \\ \implies & n_Y = \frac{N\sigma_Y}{\sigma_Y + \sigma_X} \tag{2} \end{align}</code></p><p>In the special case where <code>\(\sigma_Y = \sigma_X\)</code>, from (2) we have <code>\(n_Y = n_X = N/2\)</code>. Under the assumption that both the treatment and the control samples have the same population variance, it is optimal to have both their sample sizes equal (this is why typical A/B test designs have the same number of treatment and control units).</p><p>I plot the test statistic value against the sample size <code>\(n_Y\)</code> for some trial values of <code>\(\Delta, \mu_Y, \mu_X, \sigma_Y, \sigma_X \, \& \, N\)</code> below:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>seaborn</span> <span class=k>as</span> <span class=nn>sns</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># set distribution values</span>
</span></span><span class=line><span class=cl><span class=n>uy</span> <span class=o>=</span> <span class=mi>100</span> <span class=c1># treatment population mean</span>
</span></span><span class=line><span class=cl><span class=n>ux</span> <span class=o>=</span> <span class=mi>50</span> <span class=c1># control population mean</span>
</span></span><span class=line><span class=cl><span class=n>sy</span> <span class=o>=</span> <span class=mi>3</span> <span class=c1># treatment population standard deviation</span>
</span></span><span class=line><span class=cl><span class=n>sx</span> <span class=o>=</span> <span class=mi>2</span> <span class=c1># control population standard deviation </span>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=mi>75</span> <span class=c1># delta</span>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>=</span> <span class=mi>1000</span> <span class=c1># total units available</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># vary the number of treatment units</span>
</span></span><span class=line><span class=cl><span class=n>ny</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>100</span><span class=p>,</span> <span class=p>(</span><span class=n>N</span><span class=o>-</span><span class=mi>100</span><span class=p>),</span> <span class=mi>5</span><span class=p>)]</span> <span class=c1># optimal ny = 600</span>
</span></span><span class=line><span class=cl><span class=c1># get the test statistic value</span>
</span></span><span class=line><span class=cl><span class=c1># difference between population means</span>
</span></span><span class=line><span class=cl><span class=n>ud</span> <span class=o>=</span> <span class=n>uy</span><span class=o>-</span><span class=n>ux</span>
</span></span><span class=line><span class=cl><span class=c1># denominator of the test statistic</span>
</span></span><span class=line><span class=cl><span class=n>s</span> <span class=o>=</span> <span class=p>[</span><span class=n>sy</span><span class=o>**</span><span class=mi>2</span><span class=o>/</span><span class=n>ii</span> <span class=o>+</span> <span class=n>sx</span><span class=o>**</span><span class=mi>2</span><span class=o>/</span><span class=p>(</span><span class=n>N</span><span class=o>-</span><span class=n>ii</span><span class=p>)</span> <span class=k>for</span> <span class=n>ii</span> <span class=ow>in</span> <span class=n>ny</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=c1># calculate list of test statistics</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>=</span> <span class=p>[(</span><span class=n>d</span><span class=o>-</span><span class=n>ud</span><span class=p>)</span><span class=o>/</span><span class=n>jj</span> <span class=k>for</span> <span class=n>jj</span> <span class=ow>in</span> <span class=n>s</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># plot</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=n>style</span><span class=o>=</span><span class=s2>&#34;whitegrid&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sns</span><span class=o>.</span><span class=n>lineplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>ny</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># label the axes</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s2>&#34;Treatment Sample size&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s2>&#34;Test Statistic Size&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><img src=http://jmodeler.github.io/posts/2025-04-26-sample-size-and-effect-size/index.en_files/figure-html/unnamed-chunk-1-1.png width=672><p>Note that for the values specified above the test statistic is maximized when <code>\(n_Y = 600\)</code>, which is <code>\(\frac{N\sigma_Y}{\sigma_Y + \sigma_X} = \frac{1000*3}{3+2} = 600\)</code></p></div><footer></footer></article><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css integrity=sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0 crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js integrity=sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})'></script></section></div><footer class=footer><section class=container>©
2023 -
2025
Journeyman Modeler
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>